{
	"name": "DB2-green-taxi-clean",
	"properties": {
		"content": {
			"query": "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'green_taxi_data_CLEAN' AND schema_id = SCHEMA_ID('dbo'))\nCREATE TABLE dbo.green_taxi_data_CLEAN\nWITH\n(\n    DISTRIBUTION = ROUND_ROBIN,\n    CLUSTERED COLUMNSTORE INDEX\n)\nAS\nSELECT \n    CAST(CASE WHEN [VendorID] = 'NaN' THEN NULL ELSE [VendorID] END AS BIGINT) AS VendorID,\n    CAST([lpep_pickup_datetime] AS DATETIME2) AS lpep_pickup_datetime,\n    CAST([lpep_dropoff_datetime] AS DATETIME2) AS lpep_dropoff_datetime,\n    CAST([store_and_fwd_flag] AS VARCHAR(1)) AS store_and_fwd_flag,\n    CAST(CASE WHEN [RatecodeID] = 'NaN' THEN NULL ELSE [RatecodeID] END AS FLOAT) AS RatecodeID,\n    CAST(CASE WHEN [PULocationID] = 'NaN' THEN NULL ELSE [PULocationID] END AS BIGINT) AS PULocationID,\n    CAST(CASE WHEN [DOLocationID] = 'NaN' THEN NULL ELSE [DOLocationID] END AS BIGINT) AS DOLocationID,\n    CAST(CASE WHEN [passenger_count] = 'NaN' THEN NULL ELSE [passenger_count] END AS FLOAT) AS passenger_count,\n    CAST(CASE WHEN [trip_distance] = 'NaN' THEN NULL ELSE [trip_distance] END AS FLOAT) AS trip_distance,\n    CAST(CASE WHEN [fare_amount] = 'NaN' THEN NULL ELSE [fare_amount] END AS FLOAT) AS fare_amount,\n    CAST(CASE WHEN [extra] = 'NaN' THEN NULL ELSE [extra] END AS FLOAT) AS extra,\n    CAST(CASE WHEN [mta_tax] = 'NaN' THEN NULL ELSE [mta_tax] END AS FLOAT) AS mta_tax,\n    CAST(CASE WHEN [tip_amount] = 'NaN' THEN NULL ELSE [tip_amount] END AS FLOAT) AS tip_amount,\n    CAST(CASE WHEN [tolls_amount] = 'NaN' THEN NULL ELSE [tolls_amount] END AS FLOAT) AS tolls_amount,\n    CAST(CASE WHEN [ehail_fee] = 'NaN' THEN NULL ELSE [ehail_fee] END AS FLOAT) AS ehail_fee,\n    CAST(CASE WHEN [improvement_surcharge] = 'NaN' THEN NULL ELSE [improvement_surcharge] END AS FLOAT) AS improvement_surcharge,\n    CAST(CASE WHEN [total_amount] = 'NaN' THEN NULL ELSE [total_amount] END AS FLOAT) AS total_amount,\n    CAST(CASE WHEN [payment_type] = 'NaN' THEN NULL ELSE [payment_type] END AS FLOAT) AS payment_type,\n    CAST(CASE WHEN [trip_type] = 'NaN' THEN NULL ELSE [trip_type] END AS FLOAT) AS trip_type,\n    CAST(CASE WHEN [congestion_surcharge] = 'NaN' THEN NULL ELSE [congestion_surcharge] END AS FLOAT) AS congestion_surcharge\nFROM dbo.green_taxi_data_staged;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "NewYorkTaxiDB2",
				"poolName": "NewYorkTaxiDB2"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}