{
	"name": "DB2-combine_yellow-and-green-PROCEDURE",
	"properties": {
		"content": {
			"query": "CREATE PROCEDURE combine_green_and_yellow\nAS\nBEGIN\n    SELECT \n        VendorID,\n        pickup_datetime,\n        dropoff_datetime,\n        passenger_count,\n        trip_distance,\n        RatecodeID,\n        store_and_fwd_flag,\n        PULocationID,\n        DOLocationID,\n        payment_type,\n        fare_amount,\n        extra,\n        mta_tax,\n        tip_amount,\n        tolls_amount,\n        improvement_surcharge,\n        total_amount,\n        congestion_surcharge,\n        service\n    FROM (\n        SELECT \n            VendorID,\n            lpep_pickup_datetime AS pickup_datetime,\n            lpep_dropoff_datetime AS dropoff_datetime,\n            passenger_count,\n            trip_distance,\n            RatecodeID,\n            store_and_fwd_flag,\n            PULocationID,\n            DOLocationID,\n            payment_type,\n            fare_amount,\n            extra,\n            mta_tax,\n            tip_amount,\n            tolls_amount,\n            improvement_surcharge,\n            total_amount,\n            congestion_surcharge,\n            'green' AS service\n        FROM dbo.green_taxi_data\n        UNION ALL\n        SELECT \n            VendorID,\n            tpep_pickup_datetime AS pickup_datetime,\n            tpep_dropoff_datetime AS dropoff_datetime,\n            passenger_count,\n            trip_distance,\n            RatecodeID,\n            store_and_fwd_flag,\n            PULocationID,\n            DOLocationID,\n            payment_type,\n            fare_amount,\n            extra,\n            mta_tax,\n            tip_amount,\n            tolls_amount,\n            improvement_surcharge,\n            total_amount,\n            congestion_surcharge,\n            'yellow' AS service\n        FROM dbo.yellow_taxi_data_staged\n    ) AS combined_trips_data\nEND",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "NewYorkTaxiDB2",
				"poolName": "NewYorkTaxiDB2"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}